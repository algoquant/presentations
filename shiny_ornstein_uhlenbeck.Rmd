---
title: "Ornstein-Uhlenbeck process"
# author: "Jerzy Pawlowski"
affiliation: NYU Tandon School of Engineering
# date: '`r format(Sys.time(), "%m/%d/%Y")`'
email: jp3900@nyu.edu
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE)
# source("C:/Develop/R/scripts/ewma_model.R")
```

```{r ou_model, echo=FALSE}
inputPanel(
  sliderInput("volat", label="volat:",
              min=0.001, max=0.05, value=0.01, step=0.001),
  sliderInput("eq_price", label="eq_price:",
              min=1.0, max=10.0, value=5.0, step=0.1),
  sliderInput("thetav", label="thetav:",
              min=0.0001, max=0.05, value=0.005, step=0.0001)
)  # end inputPanel

renderPlot({
  
  volat <- input$volat
  eq_price <- input$eq_price
  thetav <- input$thetav
  
  # simulate Ornstein-Uhlenbeck process
  nrows <- 1000
  returns <- numeric(nrows)
  prices <- numeric(nrows)
  prices[1] <- eq_price
  set.seed(1121)  # reset random numbers
  for (i in 2:nrows) {
    returns[i] <- thetav*(eq_price - prices[i-1]) + 
      volat*rnorm(1)
    prices[i] <- prices[i-1] * exp(returns[i])
  }  # end for
  
  # plot
  plot(prices, type="l", 
       xlab="periods", ylab="prices", 
       main="Ornstein-Uhlenbeck process")
  legend("topright", 
         title=paste(c(paste0("volat = ", volat), 
                       paste0("eq_price = ", eq_price),
                       paste0("thetav = ", thetav)),
                     collapse="\n"),
         legend="", cex=1.0, 
         inset=0.1, bg="white", bty="n")
  
})  # end renderPlot
```
